{
  "id": "spreadsheet_agent",
  "owner_id": "orbimesh-vendor",
  "name": "Spreadsheet Agent",
  "description": "PRIORITY AGENT for ALL CSV and Excel files (.csv, .xlsx, .xls). Use this agent EXCLUSIVELY for any spreadsheet file. Handles display, analysis, and modification. DO NOT use Document Agent for CSV files.",
  "agent_type": "http_rest",
  "version": "1.0.0",
  "status": "active",
  "price_per_call_usd": 0.002,
  "requires_credentials": false,
  "credential_fields": [],
  "connection_config": {
    "base_url": "http://localhost:8041",
    "request_format": "form"
  },
  "endpoints": [
    {
      "endpoint": "/upload",
      "http_method": "POST",
      "request_format": "form",
      "description": "Upload CSV/XLSX and register it for queries and edits.",
      "parameters": [
        {
          "name": "file",
          "param_type": "file",
          "required": true,
          "description": "The CSV or Excel file to upload."
        }
      ]
    },
    {
      "endpoint": "/display",
      "http_method": "POST",
      "request_format": "form",
      "description": "Render a spreadsheet preview (first rows/columns) to the canvas.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "display_mode",
          "param_type": "string",
          "required": false,
          "description": "Display mode: 'full' (all rows), 'head' (first 10), 'tail' (last 10), 'sample' (random 10). Default: 'full'."
        },
        {
          "name": "max_rows",
          "param_type": "integer",
          "required": false,
          "description": "Maximum rows to display. Default: 100."
        }
      ]
    },
    {
      "endpoint": "/execute_pandas",
      "http_method": "POST",
      "request_format": "form",
      "description": "Run pandas code or natural-language instructions to transform the sheet and persist the result.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "instruction",
          "param_type": "string",
          "required": true,
          "description": "Natural language instruction. Examples: 'add a Sl.No. column', 'rename Feature1 to Subject1', 'add Total column summing each row'."
        },
        {
          "name": "show_result",
          "param_type": "boolean",
          "required": false,
          "description": "Whether to show the result in canvas. Default: true."
        }
      ]
    },
    {
      "endpoint": "/query",
      "http_method": "POST",
      "request_format": "form",
      "description": "Answer structured queries (SQL-like) over the current sheet.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "query",
          "param_type": "string",
          "required": true,
          "description": "Pandas query string for filtering (e.g., 'age > 28') OR assignment expression (e.g., 'Total = Feature1 + Feature2')."
        }
      ]
    },
    {
      "endpoint": "/nl_query",
      "http_method": "POST",
      "request_format": "json",
      "description": "Answer natural language questions about the sheet with reasoning steps.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "question",
          "param_type": "string",
          "required": true,
          "description": "Natural language question about the data."
        },
        {
          "name": "max_iterations",
          "param_type": "integer",
          "required": false,
          "description": "Maximum reasoning iterations for complex queries. Default: 5."
        }
      ]
    },
    {
      "endpoint": "/get_summary",
      "http_method": "POST",
      "request_format": "form",
      "description": "Provide a quick summary: rows, columns, and headline stats.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        }
      ]
    },
    {
      "endpoint": "/get_column_stats",
      "http_method": "POST",
      "request_format": "form",
      "description": "Compute per-column stats and type information.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "column_name",
          "param_type": "string",
          "required": true,
          "description": "The name of the column to get statistics for."
        }
      ]
    },
    {
      "endpoint": "/transform",
      "http_method": "POST",
      "request_format": "form",
      "description": "Apply common transformations (filter, sort, rename, add columns) via a compact request.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "operation",
          "param_type": "string",
          "required": true,
          "description": "Operation: 'filter', 'sort', 'group', 'drop_duplicates', 'fillna'."
        },
        {
          "name": "params",
          "param_type": "string",
          "required": true,
          "description": "JSON string with operation parameters."
        }
      ]
    }
  ],
  "tool_functions": null,
  "tool_registry": null,
  "tags": [],
  "category": null,
  "icon": null,
  "documentation_url": null,
  "public_key_pem": "-----BEGIN PUBLIC KEY-----\nYOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----",
  "capabilities": {
    "categories": [],
    "all_keywords": []
  }
}