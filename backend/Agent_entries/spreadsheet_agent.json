{
  "id": "spreadsheet_agent",
  "owner_id": "orbimesh-vendor",
  "name": "Spreadsheet Agent",
  "description": "PRIORITY AGENT for ALL CSV and Excel files (.csv, .xlsx, .xls). Use this agent EXCLUSIVELY for any spreadsheet file. Handles display, analysis, and modification. DO NOT use Document Agent for CSV files.",
  "requires_credentials": false,
  "price_per_call_usd": 0.002,
  "status": "active",
  "agent_type": "http_rest",
  "connection_config": {
    "base_url": "http://localhost:8041",
    "request_format": "form"
  },
  "endpoints": [
    {
      "endpoint": "/upload",
      "http_method": "POST",
      "request_format": "form",
      "description": "Upload a spreadsheet file (CSV or Excel). This MUST be called first before any other endpoint. Returns a file_id required for all subsequent operations. Use when user provides a CSV or Excel file.",
      "parameters": [
        {
          "name": "file",
          "param_type": "file",
          "required": true,
          "description": "The CSV or Excel file to upload."
        }
      ]
    },
    {
      "endpoint": "/display",
      "http_method": "POST",
      "request_format": "form",
      "description": "Display spreadsheet data in a visual canvas. Does NOT modify data. Use when user wants to VIEW, SEE, or SHOW the spreadsheet without making changes.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "display_mode",
          "param_type": "string",
          "required": false,
          "description": "Display mode: 'full' (all rows), 'head' (first 10), 'tail' (last 10), 'sample' (random 10). Default: 'full'."
        },
        {
          "name": "max_rows",
          "param_type": "integer",
          "required": false,
          "description": "Maximum rows to display. Default: 100."
        }
      ]
    },
    {
      "endpoint": "/execute_pandas",
      "http_method": "POST",
      "request_format": "form",
      "description": "Execute ANY data modification using natural language. Supports: adding columns (Sl.No., Total, averages), renaming/deleting columns, filtering, sorting, grouping, calculations, and ANY data transformation. Use for ADD, REMOVE, RENAME, CALCULATE, SUM, AVERAGE, FILTER, SORT, GROUP operations.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "instruction",
          "param_type": "string",
          "required": true,
          "description": "Natural language instruction. Examples: 'add a Sl.No. column', 'rename Feature1 to Subject1', 'add Total column summing each row'."
        },
        {
          "name": "show_result",
          "param_type": "boolean",
          "required": false,
          "description": "Whether to show the result in canvas. Default: true."
        }
      ]
    },
    {
      "endpoint": "/query",
      "http_method": "POST",
      "request_format": "form",
      "description": "Filter data or create new columns from expressions (e.g., 'age > 30' or 'Total = A + B'). Use for simple filtering and column calculations.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "query",
          "param_type": "string",
          "required": true,
          "description": "Pandas query string for filtering (e.g., 'age > 28') OR assignment expression (e.g., 'Total = Feature1 + Feature2')."
        }
      ]
    },
    {
      "endpoint": "/nl_query",
      "http_method": "POST",
      "request_format": "json",
      "description": "Ask analytical questions about the data in plain English. Use for questions like 'What is the average?', 'How many rows?', 'Who has the highest value?'. NOT for modifications.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "question",
          "param_type": "string",
          "required": true,
          "description": "Natural language question about the data."
        },
        {
          "name": "max_iterations",
          "param_type": "integer",
          "required": false,
          "description": "Maximum reasoning iterations for complex queries. Default: 5."
        }
      ]
    },
    {
      "endpoint": "/get_summary",
      "http_method": "POST",
      "request_format": "form",
      "description": "Get spreadsheet metadata: headers, data types, row count, and preview of first 5 rows. Use to understand structure before operations.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        }
      ]
    },
    {
      "endpoint": "/get_column_stats",
      "http_method": "POST",
      "request_format": "form",
      "description": "Get descriptive statistics for a numeric column (min, max, mean, std, etc.).",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "column_name",
          "param_type": "string",
          "required": true,
          "description": "The name of the column to get statistics for."
        }
      ]
    },
    {
      "endpoint": "/transform",
      "http_method": "POST",
      "request_format": "form",
      "description": "Apply predefined transformations with explicit parameters. Use for structured operations like filter, sort, group, drop_duplicates, fillna.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file_id from /upload endpoint."
        },
        {
          "name": "operation",
          "param_type": "string",
          "required": true,
          "description": "Operation: 'filter', 'sort', 'group', 'drop_duplicates', 'fillna'."
        },
        {
          "name": "params",
          "param_type": "string",
          "required": true,
          "description": "JSON string with operation parameters."
        }
      ]
    },
    {
      "endpoint": "/create",
      "http_method": "POST",
      "request_format": "json",
      "description": "CREATE a new spreadsheet from raw text, CSV data, or by transforming existing content using LLM. Use when: orchestrator passes data to create a CSV/Excel, user wants to convert text to spreadsheet, or generate sample data.",
      "parameters": [
        {
          "name": "content",
          "param_type": "string",
          "required": false,
          "description": "Raw text, CSV data, or natural language content to transform into a spreadsheet."
        },
        {
          "name": "reference_file_id",
          "param_type": "string",
          "required": false,
          "description": "File ID of an existing file to use as source data."
        },
        {
          "name": "instruction",
          "param_type": "string",
          "required": false,
          "description": "Natural language instruction for how to structure the data (e.g., 'Extract key metrics as columns')."
        },
        {
          "name": "output_format",
          "param_type": "string",
          "required": false,
          "description": "Output format: 'csv' or 'xlsx'. Default: 'csv'."
        },
        {
          "name": "output_filename",
          "param_type": "string",
          "required": false,
          "description": "Filename for the created spreadsheet."
        }
      ]
    }
  ]
}