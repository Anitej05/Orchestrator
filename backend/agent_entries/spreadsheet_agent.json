{
  "id": "spreadsheet_agent",
  "owner_id": "orbimesh-vendor",
  "name": "Spreadsheet Agent",
  "description": "PRIORITY AGENT for ALL CSV and Excel files (.csv, .xlsx, .xls). Use this agent EXCLUSIVELY for any spreadsheet file. Unified LLM-powered interface for display, analysis, queries, and transformations. DO NOT use Document Agent for CSV files.",
  "agent_type": "http_rest",
  "version": "3.0.0",
  "status": "active",
  "price_per_call_usd": 0.002,
  "requires_credentials": false,
  "credential_fields": [],
  "connection_config": {
    "base_url": "http://localhost:9000"
  },
  "endpoints": [
    {
      "endpoint": "/execute",
      "http_method": "POST",
      "request_format": "form",
      "description": "UNIFIED execution endpoint for ALL spreadsheet operations. Supports: file upload (include 'file'), natural language queries (include 'prompt'), and direct actions (include 'action' + 'params'). LLM-powered task decomposition handles complex multi-step operations automatically.",
      "parameters": [
        {
          "name": "prompt",
          "param_type": "string",
          "required": false,
          "description": "Natural language instruction. REQUIRED if operating on an existing file. If omitted during file upload, defaults to summary."
        },
        {
          "name": "action",
          "param_type": "string",
          "required": false,
          "description": "Direct action name: 'filter', 'sort', 'aggregate', 'add_column', 'drop_column', 'transform', 'export'. Use with 'params' for programmatic access."
        },
        {
          "name": "params",
          "param_type": "string",
          "required": false,
          "description": "JSON string with action parameters. Required when using 'action' parameter."
        },
        {
          "name": "file",
          "param_type": "file",
          "required": false,
          "description": "CSV or Excel file to upload. Include this to register a new file for operations."
        },
        {
          "name": "thread_id",
          "param_type": "string",
          "required": false,
          "description": "Conversation thread ID for multi-turn sessions. Files and context persist within a thread."
        },
        {
          "name": "task_id",
          "param_type": "string",
          "required": false,
          "description": "Task ID for resuming paused operations (use with /continue endpoint)."
        }
      ]
    },
    {
      "endpoint": "/execute/json",
      "http_method": "POST",
      "request_format": "json",
      "description": "JSON body version of /execute for programmatic access. Same functionality as /execute but accepts JSON body instead of form data.",
      "parameters": [
        {
          "name": "prompt",
          "param_type": "string",
          "required": false,
          "description": "Natural language instruction. REQUIRED if operating on an existing file."
        },
        {
          "name": "action",
          "param_type": "string",
          "required": false,
          "description": "Direct action name."
        },
        {
          "name": "params",
          "param_type": "object",
          "required": false,
          "description": "Action parameters as object."
        },
        {
          "name": "thread_id",
          "param_type": "string",
          "required": false,
          "description": "Thread ID for session persistence."
        },
        {
          "name": "file_content",
          "param_type": "string",
          "required": false,
          "description": "Base64-encoded file content for uploads."
        },
        {
          "name": "filename",
          "param_type": "string",
          "required": false,
          "description": "Filename when using file_content."
        },
        {
          "name": "file_path",
          "param_type": "string",
          "required": false,
          "description": "Full local file path to load. Used by orchestrator to pass spreadsheet location."
        },
        {
          "name": "file_id",
          "param_type": "string",
          "required": false,
          "description": "File ID for referencing an already-uploaded spreadsheet file."
        },
        {
          "name": "task_id",
          "param_type": "string",
          "required": false,
          "description": "Task ID for resuming paused operations."
        }
      ]
    },
    {
      "endpoint": "/continue",
      "http_method": "POST",
      "request_format": "json",
      "description": "Resume a paused task with user input. Use when /execute returns status='needs_input' and a task_id.",
      "parameters": [
        {
          "name": "task_id",
          "param_type": "string",
          "required": true,
          "description": "The task_id returned from /execute when status was 'needs_input'."
        },
        {
          "name": "user_response",
          "param_type": "string",
          "required": true,
          "description": "User's response to the clarification question."
        },
        {
          "name": "thread_id",
          "param_type": "string",
          "required": false,
          "description": "Thread ID for session context."
        }
      ]
    },
    {
      "endpoint": "/health",
      "http_method": "GET",
      "description": "Health check endpoint with cache statistics.",
      "parameters": []
    },
    {
      "endpoint": "/files",
      "http_method": "GET",
      "description": "List all files in the current session.",
      "parameters": [
        {
          "name": "thread_id",
          "param_type": "string",
          "required": false,
          "description": "Thread ID to list files for. Default: 'default'."
        }
      ]
    },
    {
      "endpoint": "/files/{file_id}",
      "http_method": "GET",
      "description": "Get metadata for a specific file.",
      "parameters": [
        {
          "name": "file_id",
          "param_type": "string",
          "required": true,
          "description": "The file ID to get metadata for."
        },
        {
          "name": "thread_id",
          "param_type": "string",
          "required": false,
          "description": "Thread ID for session context."
        }
      ]
    }
  ],
  "tool_functions": null,
  "tool_registry": null,
  "tags": [],
  "category": null,
  "icon": null,
  "documentation_url": null,
  "public_key_pem": "-----BEGIN PUBLIC KEY-----\nYOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----",
  "capabilities": {
    "categories": [],
    "all_keywords": []
  }
}