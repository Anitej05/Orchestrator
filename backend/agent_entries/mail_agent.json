{
  "id": "mail_agent",
  "owner_id": "orbimesh-vendor",
  "name": "Mail Agent",
  "description": "Smart, stateful Gmail assistant. Understands context, drafts replies, summarizes batches, and extracts tasks from your inbox.",
  "agent_type": "http_rest",
  "version": "2.0.0",
  "status": "active",
  "price_per_call_usd": 0.005,
  "public_key_pem": "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAv...\n-----END PUBLIC KEY-----",
  "requires_credentials": true,
  "credential_fields": [
    {
      "name": "composio_api_key",
      "label": "Composio API Key",
      "type": "password",
      "required": true,
      "description": "Your Composio API key",
      "placeholder": "ak_..."
    }
  ],
  "connection_config": {
    "base_url": "http://localhost:8040"
  },
  "endpoints": [
    {
      "endpoint": "/execute",
      "http_method": "POST",
      "description": "PREFERRED ENDPOINT FOR COMPLEX MULTI-STEP TASKS. This endpoint can handle complex natural language prompts that require multiple internal steps (e.g., 'find emails from John, summarize them, and mark important ones'). The agent will decompose the request, execute steps sequentially, and use BIDIRECTIONAL DIALOGUE to ask clarifying questions when needed. For simple single-action requests, use the specific endpoints below instead.",
      "parameters": [
        {
          "name": "action",
          "param_type": "string",
          "required": false,
          "description": "OPTIONAL: Specific action to execute (e.g., 'search', 'summarize', 'mark'). If omitted, provide 'prompt' instead for complex multi-step requests."
        },
        {
          "name": "prompt",
          "param_type": "string",
          "required": false,
          "description": "RECOMMENDED FOR COMPLEX TASKS: Natural language prompt describing the full request (e.g., 'Find all emails from John Smith, summarize them, and mark any containing deadlines as important'). The agent will decompose this internally and handle multi-step execution with dialogue if clarification is needed."
        },
        {
          "name": "payload",
          "param_type": "object",
          "required": false,
          "description": "Arguments for the action (only needed if using 'action' parameter)"
        },
        {
          "name": "task_id",
          "param_type": "string",
          "required": false,
          "description": "Task ID for tracking conversation state across dialogue turns"
        }
      ]
    },
    {
      "endpoint": "/continue",
      "http_method": "POST",
      "description": "Resume a paused task with an answer to the agent's question.",
      "parameters": [
        {
          "name": "task_id",
          "param_type": "string",
          "required": true,
          "description": "Task ID to resume"
        },
        {
          "name": "answer",
          "param_type": "string",
          "required": true,
          "description": "Answer to the agent's question"
        }
      ]
    },
    {
      "endpoint": "/search",
      "http_method": "POST",
      "description": "Smart semantic search with NATURAL LANGUAGE support. Accepts plain English queries like 'find emails about project deadlines' or 'recent messages from my boss'. The agent internally converts natural language to Gmail search syntax using LLM. Stores results for follow-up actions like summarization or action extraction.",
      "parameters": [
        {
          "name": "query",
          "param_type": "string",
          "required": true,
          "description": "Natural language query (e.g., 'emails about idioms', 'invoices from Amazon last month', 'unread messages from Google'). The agent converts this to Gmail search syntax automatically."
        },
        {
          "name": "max_results",
          "param_type": "integer",
          "required": false,
          "description": "Max results (default: 10)"
        }
      ]
    },
    {
      "endpoint": "/summarize_emails",
      "http_method": "POST",
      "description": "Summarize multiple emails. If no IDs are provided, it summarizes the results of the last search.",
      "parameters": [
        {
          "name": "message_ids",
          "param_type": "array",
          "required": false,
          "description": "List of message IDs to summarize"
        },
        {
          "name": "use_history",
          "param_type": "boolean",
          "required": false,
          "description": "Use last search results if IDs empty (default: True)"
        }
      ]
    },
    {
      "endpoint": "/draft_reply",
      "http_method": "POST",
      "description": "Generate a context-aware reply draft based on thread history and user intent.",
      "parameters": [
        {
          "name": "message_id",
          "param_type": "string",
          "required": true,
          "description": "ID of the email to reply to"
        },
        {
          "name": "intent",
          "param_type": "string",
          "required": true,
          "description": "Your intent (e.g., 'thank them and confirm', 'ask to reschedule')"
        }
      ]
    },
    {
      "endpoint": "/extract_action_items",
      "http_method": "POST",
      "description": "Extract tasks, deadlines, and meetings from specific emails or last search results.",
      "parameters": [
        {
          "name": "message_ids",
          "param_type": "array",
          "required": false,
          "description": "Email IDs to scan"
        },
        {
          "name": "use_history",
          "param_type": "boolean",
          "required": false,
          "description": "Scan last search results if IDs empty"
        }
      ]
    },
    {
      "endpoint": "/send_email",
      "http_method": "POST",
      "description": "Send a new email. Supports HTML, attachments, and PREVIEW. To pause and review draft, set show_preview=true first.",
      "parameters": [
        {
          "name": "to",
          "param_type": "array",
          "required": true,
          "description": "Recipient address(es)"
        },
        {
          "name": "subject",
          "param_type": "string",
          "required": true,
          "description": "Email subject"
        },
        {
          "name": "body",
          "param_type": "string",
          "required": true,
          "description": "Email body (Markdown/HTML/Text)"
        },
        {
          "name": "is_html",
          "param_type": "boolean",
          "required": false,
          "description": "Format as HTML? (default: false)"
        },
        {
          "name": "attachment_file_ids",
          "param_type": "array",
          "required": false,
          "description": "File IDs to attach"
        },
        {
          "name": "show_preview",
          "param_type": "boolean",
          "required": false,
          "description": "SET TO TRUE to pause and show draft in canvas before sending. Default: False (sends immediately)"
        }
      ]
    },
    {
      "endpoint": "/manage_emails",
      "http_method": "POST",
      "description": "Unified endpoint to Archive, Delete, Star, Label, or Mark Read/Unread.",
      "parameters": [
        {
          "name": "message_ids",
          "param_type": "array",
          "required": false,
          "description": "List of message IDs. If empty, uses last search results."
        },
        {
          "name": "action",
          "param_type": "string",
          "required": true,
          "description": "Action: mark_read, mark_unread, archive, delete, star, unstar, add_labels, remove_labels"
        },
        {
          "name": "labels",
          "param_type": "array",
          "required": false,
          "description": "Required for add/remove_labels"
        },
        {
          "name": "use_history",
          "param_type": "boolean",
          "required": false,
          "description": "Apply to last search results if IDs empty (default: True)"
        }
      ]
    },
    {
      "endpoint": "/download_attachments",
      "http_method": "POST",
      "description": "Download all attachments from an email and save them to the agent's file system for analysis.",
      "parameters": [
        {
          "name": "message_id",
          "param_type": "string",
          "required": true,
          "description": "Gmail message ID"
        }
      ]
    },
    {
      "endpoint": "/get_message",
      "http_method": "POST",
      "description": "Fetch the full details of a single message. Includes AI ANALYSIS of attachments (will advise if you need to download).",
      "parameters": [
        {
          "name": "message_id",
          "param_type": "string",
          "required": true,
          "description": "Gmail message ID"
        }
      ]
    }
  ]
}